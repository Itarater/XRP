<Ui xmlns="http://www.blizzard.com/wow/ui/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.blizzard.com/wow/ui/ ..\..\FrameXML\UI.xsd">
<!--
	Â© Justin Snelgrove
	(C) 2008-2011 Rabbit <rabbit.magtheridon@gmail.com>

	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
	<Button name="XRPMinimapBase" movable="true" virtual="true">
		<KeyValues>
			<KeyValue key="initialize" value="EasyMenu_Initialize" type="global"/>
			<KeyValue key="displayMode" value="MENU"/>
			<!-- This is kinda a hack. -->
			<KeyValue key="SetHeight" value="assert" type="global"/>
			<KeyValue key="point" value="TOPLEFT"/>
			<KeyValue key="relativePoint" value="BOTTOMLEFT"/>
			<KeyValue key="xOffset" value="0" type="number"/>
			<KeyValue key="yOffset" value="0" type="number"/>
		</KeyValues>
		<Size x="31" y="31"/>
		<Layers>
			<Layer level="BACKGROUND">
				<Texture parentKey="Icon" file="Interface\Icons\INV_Misc_QuestionMark">
					<Size x="20" y="20"/>
					<Anchors>
						<Anchor point="TOPLEFT" x="6" y="-5"/>
					</Anchors>
				</Texture>
			</Layer>
			<Layer level="ARTWORK">
				<Texture parentKey="Dim" hidden="true">
					<Size x="20" y="20"/>
					<Anchors>
						<Anchor point="TOPLEFT" x="6" y="-5"/>
					</Anchors>
					<Color r="0" g="0" b="0" a="0.4"/>
				</Texture>
			</Layer>
			<Layer level="OVERLAY">
				<Texture file="Interface\Minimap\MiniMap-TrackingBorder">
					<Size x="53" y="53"/>
					<Anchors>
						<Anchor point="TOPLEFT"/>
					</Anchors>
				</Texture>
			</Layer>
		</Layers>
		<HighlightTexture alphaMode="ADD" file="Interface\Minimap\UI-Minimap-ZoomButton-Highlight"/>
		<Scripts>
			<OnClick>
				if button == "LeftButton" then
					if xrp.units.target and xrp.units.target.fields.VA then
						xrp:View("target")
					else
						xrp:StatusToggle()
					end
					self:GetScript("OnEnter")(self, true)
					CloseDropDownMenus()
				elseif button == "RightButton" then
					ToggleDropDownMenu(nil, nil, self, self, nil, nil, self.baseMenuList)
					PlaySound("igMainMenuOptionCheckBoxOn")
				end
			</OnClick>
			<OnMouseDown>
				self.Dim:Show()
			</OnMouseDown>
			<OnMouseUp>
				self.Dim:Hide()
			</OnMouseUp>
			<OnEnter>
				if motion then
					GameTooltip:SetOwner(self, "ANCHOR_BOTTOMLEFT", 0, 32)
					GameTooltip:SetText(xrp.current.fields.NA)
					GameTooltip:AddLine(" ")
					GameTooltip:AddLine(("Profile: |cffffffff%s|r"):format(xrpSaved.selected))
					local FC = xrp.current.fields.FC
					if FC and FC ~= "0" then
						GameTooltip:AddLine(("Status: |cff%s%s|r"):format(FC == "1" and "99664d" or "66b380", xrp.values.FC[FC]))
					end
					local CU = xrp.current.fields.CU
					if CU then
						GameTooltip:AddLine(" ")
						GameTooltip:AddLine("Currently:")
						GameTooltip:AddLine(("|cffe6b399%s|r"):format(CU or "None"), nil, nil, nil, true)
					end
					GameTooltip:AddLine(" ")
					if xrp.units.target and xrp.units.target.fields.VA then
						GameTooltip:AddLine("|cffffeeaaClick to view your target's profile.|r")
					elseif not FC or FC == "0" or FC == "1" then
						GameTooltip:AddLine("|cff66b380Click for in character.|r")
					else
						GameTooltip:AddLine("|cff99664dClick for out of character.|r")
					end
					GameTooltip:AddLine("|cff999999Right click for the menu.|r")
					GameTooltip:Show()
				end
			</OnEnter>
			<OnLeave>
				GameTooltip:Hide()
				self.Dim:Hide()
			</OnLeave>
		</Scripts>
	</Button>
	<Button name="XRPMinimap" inherits="XRPMinimapBase" virtual="true">
		<Scripts>
			<OnDragStart>
				self:LockHighlight()
				self:SetScript("OnUpdate", self.OnUpdate)
			</OnDragStart>
			<OnDragStop>
				self:SetScript("OnUpdate", nil)
				self:UnlockHighlight()
			</OnDragStop>
			<OnLoad>
				self:RegisterForClicks("anyUp")
				self:SetDontSavePosition()
				self:RegisterForDrag("LeftButton")
				self:SetClampedToScreen(false)
				self:SetFrameLevel(8)
			</OnLoad>
		</Scripts>
	</Button>
	<Button name="XRPButton" inherits="XRPMinimapBase" virtual="true">
		<Scripts>
			<OnDragStart>
				if IsShiftKeyDown() then
					self.Dim:Hide()
					self:LockHighlight()
					self:StartMoving()
					self.moving = true
				end
			</OnDragStart>
			<OnLoad>
				self:RegisterForClicks("anyUp")
				self:SetDontSavePosition()
				self:RegisterForDrag("RightButton")
				self:SetClampedToScreen(true)
			</OnLoad>
		</Scripts>
	</Button>
	<Script file="minimap.lua"/>
</Ui>
